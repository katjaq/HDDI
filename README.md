# Hypothesis-driven Diffusion Imaging

A model of axonal fibre growth in a brain.

This model aims at investigating how much of a the real connectivity of a brain can be reproduced from a set of minimal hypotheses:

1. Fibres grow from the neocortical surface until they reach another neuronal target,
2. Fibres occupy space, therefore, the density of the white matter is relatively homogeneous and bounded by physical constraints (in other words, all fibres cannot cross through the same point at the same time)
3. Fibres are sticky, their trajectory tends to follow the main anisotropy in their local substrate.

The code implements these hypotheses one after the other, growing fibres on a series of geometries. Some of these geometries are generated in the code (ellipsoid, parallelepiped), some are obtained from segmentations of real brains.

In addition to generating sets of fibres, the code can produce volumes with data similar to diffusion-weighted MRI (DWI) datasets. These volumes can be analysed as normal DWI data, and we use Mrtrix3 to generate tractograms.

Finally, we explore how much of the known patterns of brain connectivity can be reproduced by the model, for example, the perpendicular orientation of fibres in the gyral crowns, the parallel orientation of fibres in sulcal fundi, the bending of fibres at the exit of gyri, the graph-theoretical properties of the tractograms and their allometric scaling.

## Installing an running the code
After downloading, install the modules required by the code using

`npm install`

The different source code files and resources are combined into a single file using `Gulp`. To run all the gulp tasks, enter the command

`gulp`

Finally, run all the experiments by executing the `hddi.js` file using the command

`node hddi.js`

The results will be generated in the `results` directory inside each experiment.

## File organisation

<pre>
├─.eslintrc.js        Linting rules for the code
├─.git                Git folder (never touch!)
├─.gitignore          List of files that we don't want git to track
├─data/               Brain segmentations
|
├─experiments/        Experiments code
| ├─01-ellipsoid        experiment 1: growth on an ellipsoid
| | ├─results/            results, generated by the simulation (initially empty)
| | ├─script.js           experiment script and parameters
| |
| |─02-rectangle        experiment 2: growth on a parallelepiped
|   ├─results/            results generated by the simulation (initially empty)
|   ├─script.js           experiment script
| 
├─gulpfile.js         List of gulp tasks for building the final code
├─hddi.js             The final code, generated by Gulp (do not edit directly)
├─interfaces/         Javascript interfaces to neuroimaging packages
| ├─fsl.js
| ├─mrtrix.js
|
├─node_modules/       Modules installed by `npm install`, not tracked by git
|
├─package-lock.json   Generated by npm
├─package.json        Generated by npm
├─previous/           Previous code, kept for reference
|
├─ReadMe.Md           This ReadMe file
├─src/                Source code
| ├─app.js              The main app code
| ├─dti-test.js         Test of the dti.js code
| ├─dti.js              Diffusion tensor fitting
| ├─extend.js           The `extend` function, used to extend js objects
| ├─gtable-6.txt        An example DWI gradient table with 6 directions
| ├─gui.js              GUI code (not used in the offline version)
| ├─mii.js              Nifti1 help functions
| ├─sim.js              The model code
|
├─web/                Files for the web version of the code
  ├─favicon.ico
  ├─img/
  |
  ├─index.html
  ├─main.css
</pre>